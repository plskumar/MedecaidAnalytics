<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Medicaid Member Dashboard</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- React 18 & ReactDOM 18 -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>

  <!-- Babel for JSX -->
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  <!-- Chart.js for charts -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    }

    body {
      background: #0f172a;
      color: #e5e7eb;
    }

    .app-container {
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    header {
      width: 100%;
      overflow: hidden;
    }

    .banner {
      width: 100%;
      height: 220px;
      background-image: url("https://images.pexels.com/photos/6129681/pexels-photo-6129681.jpeg?auto=compress&cs=tinysrgb&w=1600");
      background-size: cover;
      background-position: center;
    }

    .content {
      padding: 16px 24px 32px 24px;
      max-width: 1400px;
      margin: 0 auto;
      width: 100%;
    }

    .page-title {
      margin-top: 16px;
      margin-bottom: 20px;
      font-size: 24px;
      font-weight: 600;
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(12, 1fr);
      gap: 16px;
    }

    .card {
      background: #020617;
      border-radius: 18px;
      padding: 16px 18px;
      border: 1px solid #1f2937;
      box-shadow: 0 10px 25px rgba(0,0,0,0.45);
    }

    .card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 12px;
    }

    .card-title {
      font-size: 16px;
      font-weight: 600;
      color: #e5e7eb;
    }

    .card-subtitle {
      font-size: 12px;
      color: #9ca3af;
      margin-top: 4px;
    }

    .badge {
      font-size: 11px;
      border-radius: 999px;
      padding: 4px 10px;
      border: 1px solid #4b5563;
      color: #d1d5db;
    }

    .metrics-row {
      display: flex;
      gap: 16px;
      flex-wrap: wrap;
    }

    .metric-pill {
      padding: 10px 12px;
      border-radius: 14px;
      background: #020617;
      border: 1px solid #1f2937;
      min-width: 140px;
      cursor: pointer;
      transition: border-color 0.15s ease, box-shadow 0.15s ease, background 0.15s ease;
    }

    .metric-pill:hover {
      border-color: #4b5563;
    }

    .metric-pill.active-filter {
      border-color: #22c55e;
      box-shadow: 0 0 0 1px rgba(34,197,94,0.35);
      background: #020617;
    }

    .metric-label {
      font-size: 11px;
      color: #9ca3af;
      margin-bottom: 4px;
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    .metric-value {
      font-size: 18px;
      font-weight: 600;
    }

    .metric-trend {
      margin-top: 2px;
      font-size: 11px;
      color: #6ee7b7;
    }

    .section-label {
      font-size: 11px;
      color: #9ca3af;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      margin-bottom: 6px;
    }

    .Interop-grid {
      display: grid;
      grid-template-columns: repeat(3, minmax(0, 1fr));
      gap: 10px;
      margin-top: 8px;
      margin-bottom: 10px;
    }

    .interop-stat {
      padding: 8px 10px;
      border-radius: 12px;
      background: #020617;
      border: 1px solid #1f2937;
    }

    .interop-label {
      font-size: 11px;
      color: #9ca3af;
      margin-bottom: 4px;
    }

    .interop-value {
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
    }

    .interop-value:hover {
      text-decoration: underline;
    }

    .interop-chip-row {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin-top: 4px;
    }

    .interop-chip {
      font-size: 10px;
      padding: 4px 8px;
      border-radius: 999px;
      border: 1px dashed #374151;
      color: #d1d5db;
      cursor: pointer;
      transition: border-color 0.15s ease, background 0.15s ease;
    }

    .interop-chip.active-filter {
      border-color: #22c55e;
      background: #022c22;
    }

    .tab-row {
      display: flex;
      gap: 8px;
      margin-top: 4px;
      margin-bottom: 8px;
      flex-wrap: wrap;
    }

    .tab-button {
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid #374151;
      background: #020617;
      color: #d1d5db;
      font-size: 11px;
      cursor: pointer;
    }

    .tab-button.active {
      border-color: #22c55e;
      box-shadow: 0 0 0 1px rgba(34,197,94,0.35);
    }

    .table-container {
      margin-top: 10px;
      max-height: 340px;
      overflow: auto;
      border-radius: 14px;
      border: 1px solid #1f2937;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 12px;
    }

    thead {
      background: #020617;
      position: sticky;
      top: 0;
      z-index: 5;
    }

    th, td {
      padding: 8px 10px;
      text-align: left;
      border-bottom: 1px solid #1f2937;
      white-space: nowrap;
    }

    th {
      font-size: 11px;
      color: #9ca3af;
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    tr:nth-child(even) td {
      background: #020617;
    }

    .chip {
      display: inline-flex;
      padding: 4px 8px;
      border-radius: 999px;
      font-size: 11px;
      border: 1px solid #374151;
      background: #020617;
    }

    .chip.medicaid { border-color: #22c55e; }
    .chip.medicare { border-color: #38bdf8; }
    .chip.aca { border-color: #f97316; }

    .engage-button {
      padding: 5px 10px;
      border-radius: 999px;
      border: 1px solid #22c55e;
      background: transparent;
      color: #bbf7d0;
      font-size: 11px;
      cursor: pointer;
    }

    .charts-row {
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 12px;
      margin-top: 10px;
    }

    .chart-card {
      background: #020617;
      border-radius: 14px;
      padding: 10px;
      border: 1px solid #1f2937;
    }

    .chart-title {
      font-size: 12px;
      color: #e5e7eb;
      margin-bottom: 4px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .chart-subtitle {
      font-size: 11px;
      color: #9ca3af;
      margin-bottom: 6px;
    }

    .page-footer {
      margin-top: 20px;
      font-size: 11px;
      color: #6b7280;
      display: flex;
      justify-content: space-between;
      flex-wrap: wrap;
      gap: 8px;
    }

    .page-footer span.highlight {
      color: #e5e7eb;
      font-weight: 500;
    }

    @media (max-width: 1024px) {
      .grid {
        grid-template-columns: repeat(1, minmax(0,1fr));
      }
    }

    @media (min-width: 1024px) {
      .col-span-4 { grid-column: span 4 / span 4; }
      .col-span-8 { grid-column: span 8 / span 8; }
      .col-span-12 { grid-column: span 12 / span 12; }
    }

    @media (max-width: 1023px) {
      .col-span-4,
      .col-span-8,
      .col-span-12 {
        grid-column: span 12 / span 12;
      }
      .banner {
        height: 180px;
      }
    }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect, useRef } = React;

    const mockMembers = [
      {
        id: "M001",
        name: "Ana Rodriguez",
        enrollmentDate: "2023-04-12",
        redeterminationDate: "2025-02-18",
        county: "King",
        plan: "Medicaid",
        pcp: "Dr. Chang",
        lastMovementDate: "2024-11-05",
        movementType: "Moved out of County",
        program: "Medicaid",
        outreachAttempts: 2,
      },
      {
        id: "M002",
        name: "James Clark",
        enrollmentDate: "2022-11-03",
        redeterminationDate: "2025-01-07",
        county: "Pierce",
        plan: "Medicaid",
        pcp: "Dr. Shah",
        lastMovementDate: "2024-10-15",
        movementType: "No Encounter Yet",
        program: "Medicaid",
        outreachAttempts: 1,
      },
      {
        id: "M003",
        name: "Maria Lopez",
        enrollmentDate: "2024-02-19",
        redeterminationDate: "2025-03-01",
        county: "Snohomish",
        plan: "Medicaid",
        pcp: "Dr. Patel",
        lastMovementDate: "2024-08-22",
        movementType: "Moved out of Network",
        program: "Medicaid",
        outreachAttempts: 3,
      },
      {
        id: "M004",
        name: "Robert Hill",
        enrollmentDate: "2021-09-30",
        redeterminationDate: "2025-04-10",
        county: "King",
        plan: "Medicare",
        pcp: "Dr. Green",
        lastMovementDate: "2024-09-12",
        movementType: "No Encounter Yet",
        program: "Medicare",
        outreachAttempts: 0,
      },
      {
        id: "M005",
        name: "Wei Chen",
        enrollmentDate: "2023-07-11",
        redeterminationDate: "2025-02-03",
        county: "Pierce",
        plan: "ACA",
        pcp: "Dr. Singh",
        lastMovementDate: "2024-10-30",
        movementType: "Moved out of County",
        program: "ACA",
        outreachAttempts: 1,
      },
    ];

    const App = () => {
      const [selectedSection, setSelectedSection] = useState("unmatched"); // unmatched vs all
      const [movementFilter, setMovementFilter] = useState("ALL"); // ALL | MOVED_OUT_COUNTY | NO_ENCOUNTER | MOVED_OUT_NETWORK | ASSIGNED | ENCOUNTER_30D | REDETERMINATION_90D

      const pieChartRef = useRef(null);
      const histChartRef = useRef(null);
      const pieInstance = useRef(null);
      const histInstance = useRef(null);

      const totalMedicaid = 12457;
      const encounterPct = 68.4;
      const redeterminations90d = 842;

      const totalUniqueCCDAs = 15893;
      const unmatchedCCDAs = 1376;
      const unmatchedByProgram = {
        Medicare: 312,
        ACA: 289,
        Medicaid: 775,
      };

      const shohIndex = 0.73;

      const histogramBuckets = {
        "Moved out of County": 14,
        "No Encounter Yet": 28,
        "Moved out of Network": 9,
      };

      const mapMovementFilterLabel = (filter) => {
        switch (filter) {
          case "MOVED_OUT_COUNTY":
            return "Moved out of County";
          case "NO_ENCOUNTER":
            return "No Encounter Yet";
          case "MOVED_OUT_NETWORK":
            return "Moved out of Network";
          case "ENCOUNTER_30D":
            return "Members with 30d Encounter (sample)";
          case "REDETERMINATION_90D":
            return "Members with 90d Redetermination (sample)";
          case "ASSIGNED":
            return "All Assigned Members (sample)";
          default:
            return "All Unmatched Members";
        }
      };

      const applyFilterToMembers = () => {
        let baseList =
          selectedSection === "unmatched"
            ? mockMembers.filter((m) => m.program === "Medicaid")
            : mockMembers;

        switch (movementFilter) {
          case "MOVED_OUT_COUNTY":
            return baseList.filter((m) => m.movementType === "Moved out of County");
          case "NO_ENCOUNTER":
            return baseList.filter((m) => m.movementType === "No Encounter Yet");
          case "MOVED_OUT_NETWORK":
            return baseList.filter((m) => m.movementType === "Moved out of Network");
          // For ASSIGNED / ENCOUNTER_30D / REDETERMINATION_90D weâ€™ll just show all Medicaid as a sample slice
          case "ASSIGNED":
          case "ENCOUNTER_30D":
          case "REDETERMINATION_90D":
            return baseList.filter((m) => m.program === "Medicaid");
          default:
            return baseList;
        }
      };

      const filteredMembers = applyFilterToMembers();

      useEffect(() => {
        if (!pieChartRef.current || !histChartRef.current) return;

        if (pieInstance.current) pieInstance.current.destroy();
        if (histInstance.current) histInstance.current.destroy();

        const pieCtx = pieChartRef.current.getContext("2d");
        const histCtx = histChartRef.current.getContext("2d");

        pieInstance.current = new Chart(pieCtx, {
          type: "pie",
          data: {
            labels: ["Moved out of County", "No Encounter Yet", "Moved out of Network"],
            datasets: [
              {
                data: [
                  histogramBuckets["Moved out of County"],
                  histogramBuckets["No Encounter Yet"],
                  histogramBuckets["Moved out of Network"],
                ],
              },
            ],
          },
          options: {
            plugins: {
              legend: {
                labels: { color: "#e5e7eb", font: { size: 11 } },
              },
            },
          },
        });

        histInstance.current = new Chart(histCtx, {
          type: "bar",
          data: {
            labels: Object.keys(histogramBuckets),
            datasets: [
              {
                data: Object.values(histogramBuckets),
              },
            ],
          },
          options: {
            scales: {
              x: {
                ticks: { color: "#e5e7eb", font: { size: 11 } },
                grid: { display: false },
              },
              y: {
                ticks: { color: "#9ca3af", font: { size: 10 } },
                grid: { color: "#1f2937" },
              },
            },
            plugins: {
              legend: { display: false },
            },
          },
        });
      }, []);

      return (
        <div className="app-container">
          <header>
            <div className="banner"></div>
          </header>

          <main className="content">
            <h1 className="page-title">
              Medicaid Member Dashboard
            </h1>

            <div className="grid">
              {/* Section 1 */}
              <section className="card col-span-4">
                <div className="card-header">
                  <div>
                    <div className="card-title">Assigned Medicaid Membership</div>
                    <div className="card-subtitle">
                      Click any tile to drill into the member list below
                    </div>
